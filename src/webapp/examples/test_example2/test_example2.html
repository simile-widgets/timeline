<html>
<head>
    <title>SIMILE | Timeline | Examples | Test Example 2</title>
    <link rel='stylesheet' href='../styles.css' type='text/css' />
    <script src="../../api/timeline-api.js" type="text/javascript"></script>
    <script>
        var tl;
        function onLoad() {
            var tl_el = document.getElementById("tl");
            var eventSource1 = new Timeline.DefaultEventSource();
            var eventSource2 = new Timeline.DefaultEventSource();
            
            var theme1 = Timeline.ClassicTheme.create();
            
            // create a second theme for the second band because we want it to
            // have different settings
            var theme2 = Timeline.ClassicTheme.create();
            // increase tape height
            theme2.event.tape.height = 6; // px
            theme2.event.track.height = theme2.event.tape.height + 6;

            var d = Timeline.DateTime.parseGregorianDateTime("1900")
            var bandInfos = [
                Timeline.createBandInfo({
                    width:          "50%", // will be ignored since setting width automatically
                    intervalUnit:   Timeline.DateTime.DECADE, 
                    intervalPixels: 200,
                    eventSource:    eventSource1,
                    date:           d,
                    theme:          theme1,
                    layout:         'original'  // original, overview, detailed
                }),
                Timeline.createBandInfo({
                    width:          "40%", 
                    intervalUnit:   Timeline.DateTime.DECADE, 
                    intervalPixels: 40,
                    eventSource:    eventSource2,
                    date:           d,
                    theme:          theme2,
                    layout:         'original'  // original, overview, detailed
                }),
                Timeline.createBandInfo({
                    width:          "10%", 
                    intervalUnit:   Timeline.DateTime.DECADE, 
                    intervalPixels: 50,
                    eventSource:    eventSource2,
                    date:           d,
                    theme:          theme2,
                    layout:         'overview',  // original, overview, detailed
                    syncWith:       0,
                    highlight:      true
                })
            ];
            bandInfos[1].syncWith = 0;
            bandInfos[2].syncWith = 0;
            bandInfos[2].highlight = true;
            
                        
            // Asynchronous Callback functions. Called after data arrives.
            function load_json1(json, url) {
              // Called with first json file from server
              // Also initiates loading of second Band
              
              eventSource1.loadJSON(json, url);
              // stop browser caching of data during testing by appending time
              tl.loadJSON("cubism2.js?"+ (new Date().getTime()), load_json2);
            };

            function load_json2(json, url) {
              // Called with second json file from server
              // Also (now that all events have been loaded), resizes
              // the div
              eventSource2.loadJSON(json, url);
              var new_ht = tl.autoSetWidths();
              if (new_ht != null) {
                tl_el.style.height = new_ht + "px"; // changes height on screen
                tl.layout(); // new height, need to re-do layout 
              };
            };
            
            
            // create the Timeline
            // Strategy: Initiate Ajax call for first band's data, then have its callback
            // initiate Ajax call for second band's data. Then have its callback 
            // automagically resize the overall Timeline since we will then have all
            // the data.
            tl = Timeline.create(tl_el, bandInfos, Timeline.HORIZONTAL);
            
            // stop browser caching of data during testing by appending time
            tl.loadJSON("cubism1.js?"+ (new Date().getTime()), load_json1);
        }
        
        var resizeTimerID = null;
        function onResize() {
            if (resizeTimerID == null) {
                resizeTimerID = window.setTimeout(function() {
                    resizeTimerID = null;
                    tl.layout();
                }, 500);
            }
        }
    </script>
</head>
<body onload="onLoad();" onresize="onResize();">
<ul id="path">
  <li><a href="http://simile.mit.edu/" title="Home">SIMILE</a></li>
  <li><a href="../../" title="Timeline">Timeline</a></li>
  <li><a href="../" title="Examples">Examples</a></li>
  <li><span>Cubism</span></li>
</ul>
<div id="body">
    <h1>Cubism</h1>
    
    <p>Demonstrates:
    <ul>
    <li>Automatic sizing of the Timeline band "widths." (For a horizontal Timeline, a band's "width"
    is the height of the band on the screen.) Note how the middle band is taller since its scale
    is larger and the event tapes are thicker, thus requiring more space for the events.</li>
    <li>Use of <a href="cubism1.js">JSON data</a>, thanks to Juan Manuel Caicedo.</li>
    <li>Use of event attributes <i>color</i>, <i>textColor</i>, <i>tapeImage</i>, and <i>tapeRepeat</i>. <a href='http://code.google.com/p/simile-widgets/wiki/Timeline_EventSources'>Details</a></li>
    <li>Changing the default theme</li>
    <li>Loading two different event files sequentially.</li>
    <li>The striped event has a caption attribute. Hover over the label or tape to view.</li>
    <li>Stripe courtesy of <a href='http://www.stripegenerator.com/'>Stripe Generator</a></li>
    </ul>
    
    <p>Sources:
        <ul>
            <li><a href="http://en.wikipedia.org/wiki/Monet">http://en.wikipedia.org/wiki/Monet</a></li>
            <li><a href="http://www.accents-n-art.com/artists/claude-monet-biography.html">http://www.accents-n-art.com/artists/claude-monet-biography.html</a></li>
        </ul>
    </p>
    <div id="tl" class="timeline-default" style="height: 300px;">
    </div>
</div>
</body>
</html>
